---
name: Solidity tests
description: Foundry test structure, naming, and expectations
globs:
  - "test/**/*.t.sol"
---
- Require `setUp()`; mirror `src/` layout; call `initTestBase()` when inheriting `TestBase`; label actors with `vm.label`.
- Names: `test_` (success), `testRevert_` (failures), `testBase_` (base). Use `vm.expectRevert` with specific reason and `vm.expectEmit(true, true, true, true, <addr>)` for events.
- Structure: setup → execute → assert; apply [CONV:BLANKLINES] test rules (gap after `vm.expectRevert` before call, gap before assertions/events).
- For whitelist flows inherit `TestWhitelistManagerBase` and use `addToWhitelist` / `setFunctionWhitelistBySelector` helpers.
- After test changes, run `forge test` (or narrowed scope) or state which suites remain.
