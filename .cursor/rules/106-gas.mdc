---
name: Gas and performance
description: Gas-efficiency guidance aligned with existing patterns
globs:
  - 'src/**/*.sol'
---

- Follow gas-related best practices in existing facets before introducing new micro-optimizations.
- Prefer using existing optimized libraries already in the repo (e.g., Solady/Solmate utilities) where they are in use, rather than hand-rolled low-level code.
- Do not sacrifice readability or safety for minor gas wins; explain any non-obvious optimization and justify it with expected impact.
- Avoid introducing inline assembly unless clearly needed; when used, document assumptions and invariants thoroughly.
- When implementing code, call out any potential (verified) gas saving approaches to the user so they can decide whether to apply the optimization or not.
